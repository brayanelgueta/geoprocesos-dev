System.register(["jimu-core/react","jimu-arcgis"],(function(e,t){var r={},n={};return{setters:[function(e){r.default=e.default,r.useState=e.useState},function(e){n.JimuMapViewComponent=e.JimuMapViewComponent}],execute:function(){e((()=>{var e={5756:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var n=r(1601),o=r.n(n),i=r(6314),a=r.n(i)()(o());a.push([e.id,".widgetZoneArea{background-image:linear-gradient(to top, #1e3c72 0%, #1e3c72 1%, #2a5298 100%) !important;width:100%;height:100%;margin:0 !important;padding:.5rem;overflow:hidden;color:white}.interWidgetsZA{margin:5px}.hederWidgetsZA h1{font-size:18px;color:#fff;width:100%;height:15%;margin-bottom:10px}.contentWidgetsZA p{font-size:14px;color:white}.contentWidgetsZA{padding-top:10px;display:flex}.contentI1WidgetsZA{width:50%}.contentBTNSZA{display:flex;justify-content:end;align-items:center}.btnZA{background-color:#6a6969;color:white;width:auto;height:30px;text-decoration:none;border:none;margin:6px;border-radius:5px;padding:6px 20px;display:flex;text-align:center;justify-content:center;align-items:center}",""]);const s=a},6314:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var d=0;d<e.length;d++){var u=[].concat(e[d]);n&&a[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),r&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=r):u[2]=r),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},1601:e=>{"use strict";e.exports=function(e){return e[1]}},5072:e=>{"use strict";var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],d=n.base?c[0]+n.base:c[0],u=i[d]||0,l="".concat(d," ").concat(u);i[d]=u+1;var p=r(l),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==p)t[p].references++,t[p].updater(f);else{var m=o(f,n);n.byIndex=s,t.splice(s,0,{identifier:l,updater:m,references:1})}a.push(l)}return a}function o(e,t){var r=t.domAPI(t);r.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var i=n(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=r(i[a]);t[s].references--}for(var c=n(e,o),d=0;d<i.length;d++){var u=r(i[d]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},7659:e=>{"use strict";var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},5056:(e,t,r)=>{"use strict";e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},2686:e=>{"use strict";e.exports=n},8972:e=>{"use strict";e.exports=r}},t={};function o(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,o),i.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.p="",o.nc=void 0;var i={};return o.p=window.jimuConfig.baseUrl,(()=>{"use strict";o.r(i),o.d(i,{__set_webpack_public_path__:()=>W,default:()=>N});var e=o(8972),t=o(2686),r=o(5072),n=o.n(r),a=o(7825),s=o.n(a),c=o(7659),d=o.n(c),u=o(5056),l=o.n(u),p=o(540),f=o.n(p),m=o(1113),v=o.n(m),g=o(5756),y={};y.styleTagTransform=v(),y.setAttributes=l(),y.insert=d().bind(null,"head"),y.domAPI=s(),y.insertStyleElement=f();n()(g.A,y);g.A&&g.A.locals&&g.A.locals;const h={Promise:"undefined"!=typeof window?window.Promise:void 0};var w="4.25",x="next";function b(e){if(e.toLowerCase()===x)return x;var t=e&&e.match(/^(\d)\.(\d+)/);return t&&{major:parseInt(t[1],10),minor:parseInt(t[2],10)}}function E(e){return void 0===e&&(e=w),"https://js.arcgis.com/".concat(e,"/")}function A(e){return!e||b(e)?function(e){void 0===e&&(e=w);var t=E(e),r=b(e);if(r!==x&&3===r.major){var n=r.minor<=10?"js/":"";return"".concat(t).concat(n,"esri/css/esri.css")}return"".concat(t,"esri/themes/light/main.css")}(e):e}function S(e,t){var r=A(e),n=function(e){return document.querySelector('link[href*="'.concat(e,'"]'))}(r);return n||function(e,t){if(t){var r=document.querySelector(t);r.parentNode.insertBefore(e,r)}else document.head.appendChild(e)}(n=function(e){var t=document.createElement("link");return t.rel="stylesheet",t.href=e,t}(r),t),n}var I={};function L(e,t,r){var n;r&&(n=function(e,t){var r=function(n){t(n.error||new Error("There was an error attempting to load ".concat(e.src))),e.removeEventListener("error",r,!1)};return e.addEventListener("error",r,!1),r}(e,r));var o=function(){t(e),e.removeEventListener("load",o,!1),n&&e.removeEventListener("error",n,!1)};e.addEventListener("load",o,!1)}function P(){return document.querySelector("script[data-esri-loader]")}function j(){var e=window.require;return e&&e.on}function C(e){void 0===e&&(e={});var t={};[I,e].forEach((function(e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}));var r=t.version,n=t.url||E(r);return new h.Promise((function(e,o){var i=P();if(i){var a=i.getAttribute("src");a!==n?o(new Error("The ArcGIS API for JavaScript is already loaded (".concat(a,")."))):j()?e(i):L(i,e,o)}else if(j())o(new Error("The ArcGIS API for JavaScript is already loaded."));else{var s=t.css;if(s)S(!0===s?r:s,t.insertCssBefore);i=function(e){var t=document.createElement("script");return t.type="text/javascript",t.src=e,t.setAttribute("data-esri-loader","loading"),t}(n),L(i,(function(){i.setAttribute("data-esri-loader","loaded"),e(i)}),o),document.body.appendChild(i)}}))}function M(e){return new h.Promise((function(t,r){var n=window.require.on("error",r);window.require(e,(function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];n.remove(),t(e)}))}))}function T(e,t){if(void 0===t&&(t={}),j())return M(e);var r=P(),n=r&&r.getAttribute("src");return!t.url&&n&&(t.url=n),C(t).then((function(){return M(e)}))}var Z=function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{c(n.next(e))}catch(e){i(e)}}function s(e){try{c(n.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))};const N=r=>{var n;const[o,i]=(0,e.useState)(null);return e.default.createElement("div",{className:"jimu-widget widgetZoneArea"},r.useMapWidgetIds&&1===r.useMapWidgetIds.length&&e.default.createElement(t.JimuMapViewComponent,{useMapWidgetId:null===(n=r.useMapWidgetIds)||void 0===n?void 0:n[0],onActiveViewChange:e=>{i(e)}}),e.default.createElement("div",{className:"interWidgetsZA"},e.default.createElement("div",{className:"homeZA"},e.default.createElement("div",{className:"hederWidgetsZA"},e.default.createElement("h1",null,"Proximidad de \xe1reas de Riesgo "),e.default.createElement("p",null,"Este widget permite a partir de la detecci\xf3n de \xe1reas quemadas e inundadas, generar l\xedneas de proximidad a l\xedmites urbanos m\xe1s cercanos."),e.default.createElement("div",{className:"contentWidgetsZA"},e.default.createElement("div",{className:"contentI1WidgetsZA"},e.default.createElement("h4",null,"Instrucciones de uso:"),e.default.createElement("ul",null,e.default.createElement("li",null,"Presione el bot\xf3n para generar las l\xedneas de proximidad a todos los pol\xedgonos o puntos visibles en el mapa dentro del \xc1reas de influencia."))),e.default.createElement("div",{className:"contentI1WidgetsZA contentBTNSZA"},e.default.createElement("button",{onClick:()=>Z(void 0,void 0,void 0,(function*(){if(o){const e=(()=>{if(!o)return alert("El mapa no est\xe1 cargado."),null;console.log(o.view.graphics.items);const e=o.view.graphics.items.find((e=>e.attributes&&"buffer_DI"===e.attributes.id));return e?e.geometry:(alert("Ejecuta primero el geoproceso de Detecci\xf3n de Infraestructuras."),null)})();if(!e)return;const[t,r]=yield T(["esri/geometry/geometryEngine","esri/geometry/Point"]),n=new r({x:e.extent.center.x,y:e.extent.center.y,spatialReference:e.spatialReference});console.log("jimuMapView.view.graphics.items",o.view.graphics.items);const i=o.view.map.findLayerById("tempGraphicsLayer");if(!i)return void console.error("La capa 'tempGraphicsLayer' no existe.");const a=i.graphics.items.find((e=>"polygon"===e.geometry.type&&t.intersects(e.geometry,n))),s=o.view.map.layers.filter((e=>e.visible&&"feature"===e.type&&"1958b97a0bf-layer-4"===e.id));let c=[];for(const t of s.items){const r=t.createQuery();r.geometry=e,r.spatialRelationship="intersects",r.returnGeometry=!0;try{(yield t.queryFeatures(r)).features.forEach((e=>{c.push(e.geometry)}))}catch(e){console.error(`Error consultando la capa ${t.title}:`,e)}}a&&s?((e,t)=>{Z(void 0,void 0,void 0,(function*(){if(!e||0===t.length)return void console.warn("No hay geometr\xedas para conectar.");const[r,n,i,a]=yield T(["esri/geometry/geometryEngine","esri/geometry/Polyline","esri/Graphic","esri/layers/GraphicsLayer"]);let s=o.view.map.findLayerById("proximityLinesLayer");s?s.removeAll():(s=new a({id:"proximityLinesLayer",title:"L\xedneas de Proximidad"}),o.view.map.add(s));const c=e.geometry.centroid;t.forEach((e=>{let t;if(e.centroid)t=e.centroid;else if(e.extent)t=e.extent.center;else{if("point"!==e.type)return void console.warn("Geometr\xeda sin centroide ni extent, ignorando:",e);t=e}const a=new n({paths:[[c.x,c.y],[t.x,t.y]],spatialReference:o.view.spatialReference}),d=r.geodesicLength(a,"meters"),u=d/1e3,l=new i({geometry:a,symbol:{type:"simple-line",color:[0,0,255],width:2},attributes:{distance_m:d.toFixed(2),distance_km:u.toFixed(2)},popupTemplate:{title:"L\xednea de Proximidad",content:"<b>Distancia en metros:</b>"+d.toFixed(2)+"m<br><b>Distancia en kil\xf3metros:</b> "+u.toFixed(2)+" km"}});s.add(l)}))}))})(a,c):console.log("El centroide no toca ning\xfan pol\xedgono.")}})),className:"btnZA"},"Generar L\xedneas de Proximidad")))))))};function W(e){o.p=e}})(),i})())}}}));